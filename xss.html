<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>XSS Demo</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.9/purify.min.js"></script>
</head>
<body>
  <main class="container">
    <a href="index.html" class="btn">‚Üê Back</a>
    <h1 style="margin-top:14px">Cross-Site Scripting (XSS)</h1>

    <div class="demo-wrap">
      <section class="panel">
        <h2>Vulnerable (innerHTML)</h2>
        <label>New comment</label>
        <input id="c_v" type="text" placeholder="Type comment or script tag">
        <div class="controls"><button class="btn primary" onclick="postVuln()">Post (Vulnerable)</button></div>
        <div id="feed_v" style="margin-top:10px"></div>
      </section>

      <section class="panel">
        <h2>Secure (DOMPurify)</h2>
        <label>New comment</label>
        <input id="c_s" type="text" placeholder="Type comment or script tag">
        <div class="controls"><button class="btn primary" onclick="postSafe()">Post (Sanitized)</button></div>
        <div id="feed_s" style="margin-top:10px"></div>
      </section>
    </div>

    <div class="panel" style="margin-top:12px">
      <p class="explainer">Try submitting <code>&lt;img src=x onerror=alert(1)&gt;</code> in the vulnerable feed to see how an attacker could run scripts. The secure feed sanitizes input.</p>
    </div>
  </main>

<script>
function postVuln(){
  const t = document.getElementById('c_v').value || '(empty)';
  const node = document.getElementById('feed_v');
  node.innerHTML += '<div class="code-box" style="margin-top:8px">' + t + '</div>';
}

function postSafe(){
  const t = document.getElementById('c_s').value || '(empty)';
  const clean = DOMPurify.sanitize(t);
  const node = document.getElementById('feed_s');
  const el = document.createElement('div');
  el.className = 'code-box';
  el.textContent = clean; // double-safety: textContent avoids HTML interpretation
  node.appendChild(el);
}
</script>
</body>
</html>
